{"title":"Auto Code Walker Tour","steps":[{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":212,"codeSnippet":"    private static String extractAuthorNote(PsiElement el) {\n        // Prefer Javadoc, then preceding comments on previous siblings\n        if (el instanceof PsiDocCommentOwner owner) {\n            PsiDocComment doc \u003d owner.getDocComment();\n            if (doc !\u003d null) {\n                return doc.getText();\n            }\n        }\n        PsiElement prev \u003d el.getPrevSibling();\n        while (prev instanceof PsiWhiteSpace) prev \u003d prev.getPrevSibling();\n        if (prev instanceof PsiComment c) {\n            return c.getText();\n        }\n        return \"\";\n    }","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    private static String extractAuthorNote(PsiElement el) {\n        // Prefer Javadoc, then preceding comments on previous siblings\n        if (el instanceof PsiDocCommentOwner owner) {\n            PsiDocComment doc \u003d owner.getDocComment();\n            if (doc !\u003d null) {\n                return doc.getText();\n            }\n        }\n        PsiElement prev \u003d el.getPrevSibling();\n        while (prev instanceof PsiWhiteSpace) prev \u003d prev.getPrevSibling();\n        if (prev instanceof PsiComment c) {\n            return c.getText();\n        }\n        return \"\";\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":226,"symbolName":"com.hackathon.service.SelectionModeService#extractAuthorNote","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":228,"codeSnippet":"    public void refreshEditorHighlighters(@NotNull Editor editor) {\n        clearHighlighters(editor);\n        if (!enabled) return;\n        Project p \u003d editor.getProject();\n        if (p \u003d\u003d null) return;\n        PsiFile psi \u003d getPsiFile(editor);\n        if (psi \u003d\u003d null || psi.getVirtualFile() \u003d\u003d null) return;\n        String path \u003d psi.getVirtualFile().getPath();\n        TourStateService state \u003d project.getService(TourStateService.class);\n        Document document \u003d editor.getDocument();\n\n        List\u003cRangeHighlighter\u003e list \u003d new ArrayList\u003c\u003e();\n        int index \u003d 1;\n        for (TourStep s : state.getSteps()) {\n            if (!Objects.equals(s.filePath(), path)) { index++; continue; }\n            int startLine0 \u003d Math.max(0, Math.min(document.getLineCount() - 1, s.lineNum() - 1));\n            int endLine0 \u003d Math.max(startLine0, Math.min(document.getLineCount() - 1, s.endLine() !\u003d null ? s.endLine() - 1 : startLine0));\n            int startOffset \u003d document.getLineStartOffset(startLine0);\n            int endOffset \u003d document.getLineEndOffset(endLine0);\n\n            TextAttributes attrs \u003d new TextAttributes();\n            boolean isMethod \u003d s.symbolName() !\u003d null \u0026\u0026 s.symbolName().contains(\"#\");\n            // Softer, dimmer highlight colors; class\u003dblue, method\u003dgreen\n            JBColor bg \u003d isMethod ? new JBColor(new Color(210, 245, 210), new Color(50, 70, 50))\n                                  : new JBColor(new Color(210, 230, 255), new Color(50, 60, 80));\n            attrs.setBackgroundColor(bg);\n            attrs.setEffectColor(isMethod ? new JBColor(new Color(0, 128, 0), new Color(120, 180, 120)) : JBColor.BLUE);\n            attrs.setEffectType(EffectType.BOXED);\n            attrs.setFontType(Font.BOLD);\n\n            MarkupModel markup \u003d editor.getMarkupModel();\n            RangeHighlighter rh \u003d markup.addRangeHighlighter(startOffset, endOffset, HighlighterLayer.SELECTION - 2, attrs, HighlighterTargetArea.EXACT_RANGE);\n            rh.setGutterIconRenderer(new NumberGutterIconRenderer(index));\n            list.add(rh);\n            index++;\n        }\n        editorHighlighters.put(editor, list);\n    }","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    public void refreshEditorHighlighters(@NotNull Editor editor) {\n        clearHighlighters(editor);\n        if (!enabled) return;\n        Project p \u003d editor.getProject();\n        if (p \u003d\u003d null) return;\n        PsiFile psi \u003d getPsiFile(editor);\n        if (psi \u003d\u003d null || psi.getVirtualFile() \u003d\u003d null) return;\n        String path \u003d psi.getVirtualFile().getPath();\n        TourStateService state \u003d project.getService(TourStateService.class);\n        Document document \u003d editor.getDocument();\n\n        List\u0026lt;RangeHighlighter\u0026gt; list \u003d new ArrayList\u0026lt;\u0026gt;();\n        int index \u003d 1;\n        for (TourStep s : state.getSteps()) {\n            if (!Objects.equals(s.filePath(), path)) { index++; continue; }\n            int startLine0 \u003d Math.max(0, Math.min(document.getLineCount() - 1, s.lineNum() - 1));\n            int endLine0 \u003d Math.max(startLine0, Math.min(document.getLineCount() - 1, s.endLine() !\u003d null ? s.endLine() - 1 : startLine0));\n            int startOffset \u003d document.getLineStartOffset(startLine0);\n            int endOffset \u003d document.getLineEndOffset(endLine0);\n\n            TextAttributes attrs \u003d new TextAttributes();\n            boolean isMethod \u003d s.symbolName() !\u003d null \u0026amp;\u0026amp; s.symbolName().contains(\"#\");\n            // Softer, dimmer highlight colors; class\u003dblue, method\u003dgreen\n            JBColor bg \u003d isMethod ? new JBColor(new Color(210, 245, 210), new Color(50, 70, 50))\n                                  : new JBColor(new Color(210, 230, 255), new Color(50, 60, 80));\n            attrs.setBackgroundColor(bg);\n            attrs.setEffectColor(isMethod ? new JBColor(new Color(0, 128, 0), new Color(120, 180, 120)) : JBColor.BLUE);\n            attrs.setEffectType(EffectType.BOXED);\n            attrs.setFontType(Font.BOLD);\n\n            MarkupModel markup \u003d editor.getMarkupModel();\n            RangeHighlighter rh \u003d markup.addRangeHighlighter(startOffset, endOffset, HighlighterLayer.SELECTION - 2, attrs, HighlighterTargetArea.EXACT_RANGE);\n            rh.setGutterIconRenderer(new NumberGutterIconRenderer(index));\n            list.add(rh);\n            index++;\n        }\n        editorHighlighters.put(editor, list);\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":265,"symbolName":"com.hackathon.service.SelectionModeService#refreshEditorHighlighters","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":268,"codeSnippet":"    public void refreshAllEditors() {\n        for (Editor ed : com.intellij.openapi.editor.EditorFactory.getInstance().getAllEditors()) {\n            refreshEditorHighlighters(ed);\n        }\n    }","authorNote":"/** Refresh selection highlighters and gutter numbers across all open editors. */","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e/** Refresh selection highlighters and gutter numbers across all open editors. */\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    public void refreshAllEditors() {\n        for (Editor ed : com.intellij.openapi.editor.EditorFactory.getInstance().getAllEditors()) {\n            refreshEditorHighlighters(ed);\n        }\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":272,"symbolName":"com.hackathon.service.SelectionModeService#refreshAllEditors","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":274,"codeSnippet":"private void clearAllHighlighters()","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003eprivate void clearAllHighlighters()\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":274,"type":"manual"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":280,"codeSnippet":"    private void clearHighlighters(Editor editor) {\n        List\u003cRangeHighlighter\u003e list \u003d editorHighlighters.remove(editor);\n        if (list !\u003d null) {\n            for (RangeHighlighter h : list) {\n                try { h.dispose(); } catch (Throwable ignore) {}\n            }\n        }\n    }","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    private void clearHighlighters(Editor editor) {\n        List\u0026lt;RangeHighlighter\u0026gt; list \u003d editorHighlighters.remove(editor);\n        if (list !\u003d null) {\n            for (RangeHighlighter h : list) {\n                try { h.dispose(); } catch (Throwable ignore) {}\n            }\n        }\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":287,"symbolName":"com.hackathon.service.SelectionModeService#clearHighlighters","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":290,"codeSnippet":"    public void dispose() {\n        clearAllHighlighters();\n        for (Editor ed : new ArrayList\u003c\u003e(finishHuds.keySet())) {\n            detachFinishHud(ed);\n        }\n    }","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    public void dispose() {\n        clearAllHighlighters();\n        for (Editor ed : new ArrayList\u0026lt;\u0026gt;(finishHuds.keySet())) {\n            detachFinishHud(ed);\n        }\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":295,"symbolName":"com.hackathon.service.SelectionModeService#dispose","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":274,"codeSnippet":"    private void clearAllHighlighters() {\n        for (Editor ed : new ArrayList\u003c\u003e(editorHighlighters.keySet())) {\n            clearHighlighters(ed);\n        }\n    }","authorNote":"","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    private void clearAllHighlighters() {\n        for (Editor ed : new ArrayList\u0026lt;\u0026gt;(editorHighlighters.keySet())) {\n            clearHighlighters(ed);\n        }\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":278,"symbolName":"com.hackathon.service.SelectionModeService#clearAllHighlighters","type":"method"},{"filePath":"C:/Users/lazar/IdeaProjects/JB-plugin/src/main/java/com/hackathon/service/SelectionModeService.java","lineNum":298,"codeSnippet":"    static final class NumberGutterIconRenderer extends GutterIconRenderer {\n        private final int index;\n        private final Icon icon;\n\n        NumberGutterIconRenderer(int index) {\n            this.index \u003d index;\n            this.icon \u003d new NumberIcon(index);\n        }\n\n        @Override\n        public @NotNull Icon getIcon() { return icon; }\n\n        @Override\n        public String getTooltipText() { return \"Tour Step #\" + index; }\n\n        @Override\n        public boolean equals(Object obj) { return obj instanceof NumberGutterIconRenderer r \u0026\u0026 r.index \u003d\u003d index; }\n\n        @Override\n        public int hashCode() { return Integer.hashCode(index); }\n    }","authorNote":"/** Simple numbered icon for gutter. */","aiExplanation":"\u003ch3\u003eAuthor Note\u003c/h3\u003e\u003cp\u003e/** Simple numbered icon for gutter. */\u003c/p\u003e\u003ch3\u003eCode\u003c/h3\u003e\u003cpre\u003e    static final class NumberGutterIconRenderer extends GutterIconRenderer {\n        private final int index;\n        private final Icon icon;\n\n        NumberGutterIconRenderer(int index) {\n            this.index \u003d index;\n            this.icon \u003d new NumberIcon(index);\n        }\n\n        @Override\n        public @NotNull Icon getIcon() { return icon; }\n\n        @Override\n        public String getTooltipText() { return \"Tour Step #\" + index; }\n\n        @Override\n        public boolean equals(Object obj) { return obj instanceof NumberGutterIconRenderer r \u0026amp;\u0026amp; r.index \u003d\u003d index; }\n\n        @Override\n        public int hashCode() { return Integer.hashCode(index); }\n    }\u003c/pre\u003e\u003cp\u003e\u003cem\u003e(Set OPENAI_API_KEY to enable AI explanations.)\u003c/em\u003e\u003c/p\u003e","endLine":318,"symbolName":"com.hackathon.service.SelectionModeService.NumberGutterIconRenderer","type":"class"}]}