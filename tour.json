{"title":"Auto Code Walker Tour","steps":[{"filePath":"C:/Users/bajic/source/repos/JB-plugin/src/main/java/com/hackathon/actions/FinalizeTourAction.java","lineNum":51,"codeSnippet":"    public void actionPerformed(@NotNull AnActionEvent e) {\n        Project project \u003d e.getProject();\n        if (project \u003d\u003d null) return;\n\n        TourStateService state \u003d project.getService(TourStateService.class);\n        if (state.getSteps().isEmpty()) {\n            Messages.showInfoMessage(project, \"No selections. Use \u0027Create Tour (Select Functions)\u0027 first.\", \"Create Tour\");\n            return;\n        }\n\n        OpenAIService ai \u003d com.intellij.openapi.application.ApplicationManager.getApplication().getService(OpenAIService.class);\n        List\u003cTourStep\u003e updated \u003d new ArrayList\u003c\u003e();\n        String title \u003d state.getTitle();\n        for (TourStep s : state.getSteps()) {\n            var result \u003d ai.generateExplanation(s.codeSnippet(), s.authorNote() \u003d\u003d null ? \"\" : s.authorNote());\n            String html \u003d result.htmlContent();\n            if (title \u003d\u003d null || title.isBlank() || \"Untitled Tour\".equals(title)) {\n                title \u003d result.title();\n            }\n            updated.add(new TourStep(s.filePath(), s.lineNum(), s.codeSnippet(), s.authorNote(), html, s.endLine(), s.symbolName(), s.type()));\n        }\n\n        String suggested \u003d title \u003d\u003d null || title.isBlank() ? \"Auto Code Walker Tour\" : title;\n        String input \u003d Messages.showInputDialog(project, \"Tour title:\", \"Create Tour\", null, suggested, null);\n        if (input !\u003d null \u0026\u0026 !input.isBlank()) title \u003d input.trim();\n        state.setTour(new Tour(title, updated));\n\n        String basePath \u003d project.getBasePath();\n        if (basePath \u003d\u003d null) basePath \u003d new File(\".\").getAbsolutePath();\n        File out \u003d new File(basePath, \"tour.json\");\n        if (out.exists()) {\n            int choice \u003d Messages.showYesNoDialog(project,\n                    \"File tour.json already exists in project root. Overwrite?\",\n                    \"Create Tour\",\n                    \"Overwrite\",\n                    \"Cancel\",\n                    null);\n            if (choice !\u003d Messages.YES) return;\n        }\n        try (FileWriter fw \u003d new FileWriter(out, StandardCharsets.UTF_8)) {\n            gson.toJson(new Tour(title, updated), fw);\n            Messages.showInfoMessage(project, \"Tour saved to: \" + out.getAbsolutePath(), \"Create Tour\");\n        } catch (Exception ex) {\n            Messages.showErrorDialog(project, \"Failed to save tour: \" + ex.getMessage(), \"Create Tour\");\n        }\n\n        // Disable selection mode and clear state to start fresh\n        project.getService(SelectionModeService.class).setEnabled(false);\n        state.clear();\n    }","authorNote":"","endLine":100,"symbolName":"com.hackathon.actions.FinalizeTourAction#actionPerformed","type":"method"},{"filePath":"C:/Users/bajic/source/repos/JB-plugin/src/main/java/com/hackathon/actions/CreateTourModeAction.java","lineNum":21,"codeSnippet":"    public void update(@NotNull AnActionEvent e) {\n        Editor editor \u003d e.getData(CommonDataKeys.EDITOR);\n        Project project \u003d e.getProject();\n        boolean visible \u003d false;\n        if (editor !\u003d null \u0026\u0026 project !\u003d null) {\n            SelectionModeService svc \u003d project.getService(SelectionModeService.class);\n            // Visible only if selection mode is NOT enabled\n            visible \u003d svc !\u003d null \u0026\u0026 !svc.isEnabled();\n        }\n        e.getPresentation().setEnabledAndVisible(visible);\n    }","authorNote":"","endLine":31,"symbolName":"com.hackathon.actions.CreateTourModeAction#update","type":"method"}]}